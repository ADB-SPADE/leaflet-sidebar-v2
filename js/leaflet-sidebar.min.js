L.Control.Sidebar=L.Control.extend({includes:L.Mixin.Events,options:{position:"left"},initialize:function(t,e){var i,s,a,o,n;for(L.setOptions(this,e),this._sidebar=L.DomUtil.get(t),null===this._sidebar&&(this._sidebar=L.DomUtil.create("div","sidebar collapsed",document.body)),L.DomUtil.addClass(this._sidebar,"sidebar-"+this.options.position),L.Browser.touch&&L.DomUtil.addClass(this._sidebar,"leaflet-touch"),this._paneContainer=this._sidebar.querySelector("div.sidebar-content"),null===this._paneContainer&&(this._paneContainer=L.DomUtil.create("div","sidebar-content",this._sidebar)),o=this._sidebar.querySelectorAll("ul.sidebar-tabs, div.sidebar-tabs > ul"),this._tabContainerTop=o[0]||null,this._tabContainerBottom=o[1]||null,null===this._tabContainerTop&&(n=L.DomUtil.create("div","sidebar-tabs",this._sidebar),this._tabContainerTop=L.DomUtil.create("ul","",n)),null===this._tabContainerBottom&&(n=this._tabContainerTop.parentNode,this._tabContainerBottom=L.DomUtil.create("ul","",n)),this._tabitems=[],i=0;i<this._tabContainerTop.children.length;i++)a=this._tabContainerTop.children[i],a._sidebar=this,this._tabitems.push(a);for(i=0;i<this._tabContainerBottom.children.length;i++)a=this._tabContainerBottom.children[i],a._sidebar=this,this._tabitems.push(a);for(this._panes=[],this._closeButtons=[],i=0;i<this._paneContainer.children.length;i++)if(a=this._paneContainer.children[i],"DIV"===a.tagName&&L.DomUtil.hasClass(a,"sidebar-pane")){this._panes.push(a);var l=a.querySelectorAll(".sidebar-close");for(s=0,len=l.length;s<len;s++)this._closeButtons.push(l[s])}},addTo:function(t){var e;for(this._map=t,e=0;e<this._tabitems.length;e++)this._tabClick(this._tabitems[e],"on");for(e=0;e<this._closeButtons.length;e++)this._closeClick(this._closeButtons[e],"on");return this},removeFrom:function(t){console.log("removeFrom() has been deprecated, please use remove() instead as support for this function will be ending soon."),this.remove(t)},remove:function(t){var e;for(this._map=null,e=0;e<this._tabitems.length-1;e++)this._tabClick(this._tabitems[e],"off");for(e=0;this._closeButtons.length;e++)this._closeClick(this._closeButtons[e],"off");return this},open:function(t){var e,i,s;if(s=this._getTab(t),L.DomUtil.hasClass(s,"disabled"))return this;for(e=0;e<this._panes.length;e++)i=this._panes[e],i.id===t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");for(e=0;e<this._tabitems.length;e++)i=this._tabitems[e],i.querySelector("a").hash==="#"+t?L.DomUtil.addClass(i,"active"):L.DomUtil.hasClass(i,"active")&&L.DomUtil.removeClass(i,"active");return this.fire("content",{id:t}),L.DomUtil.hasClass(this._sidebar,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._sidebar,"collapsed")),this},close:function(){var t;for(t=0;t<this._tabitems.length;t++){var e=this._tabitems[t];L.DomUtil.hasClass(e,"active")&&L.DomUtil.removeClass(e,"active")}return L.DomUtil.hasClass(this._sidebar,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._sidebar,"collapsed")),this},addPanel:function(t){var e,i,s,a,o;for("string"==typeof t.pane?(i=L.DomUtil.create("DIV","sidebar-pane",this._paneContainer),i.innerHTML=t.pane):(i=t.pane,this._paneContainer.appendChild(i)),i.id=t.id,s=L.DomUtil.create("li",""),a=L.DomUtil.create("a","",s),a.href="#"+t.id,a.role="tab",a.innerHTML=t.tab,s._sidebar=this,"bottom"===t.position?this._tabContainerBottom.appendChild(s):this._tabContainerTop.appendChild(s),this._panes.push(i),this._tabitems.push(s),this._tabClick(s,"on"),o=i.querySelectorAll(".sidebar-close"),e=0;e<o.length;e++)this._closeButtons.push(o[e]),this._closeClick(o[e],"on");return this},removePanel:function(t){var e,i,s,a;for(e=0;e<this._panes.length;e++)if(this._panes[e].id===t){for(s=this._panes[e],this._tabClick(this.tabitems[e],"off"),a=s.querySelectorAll(".sidebar-close"),i=0;e<a.length;e++)this._closeClick(a[i],"off");s.remove(),this._panes.slice(e,1),this._tabitems[e].remove(),this._tabitems.slice(e,1);break}return this},enablePanel:function(t){var e=this._getTab(t);return L.DomUtil.removeClass(e,"disabled"),this},disablePanel:function(t){var e=this._getTab(t);return L.DomUtil.addClass(e,"disabled"),this},_tabClick:function(t,e){var i=t.querySelector("a");if(!i.hasAttribute("href")||"#"===i.getAttribute("href")[0]){var s=function(){L.DomUtil.hasClass(this,"active")?this._sidebar.close():L.DomUtil.hasClass(this,"disabled")||this._sidebar.open(this.querySelector("a").hash.slice(1))};"on"===e?L.DomEvent.on(t.querySelector("a"),"click",L.DomEvent.preventDefault).on(t.querySelector("a"),"click",s,t):L.DomEvent.off(t.querySelector("a"),"click",s)}},_closeClick:function(t,e){var i=function(){this.close()};"on"===e?L.DomEvent.on(t,"click",i,this):L.DomEvent.off(t,"click",i,this)},_getTab:function(t){var e,i;for(e=0;e<this._tabitems.length;e++)if(i=this._tabitems[e],i.querySelector("a").hash==="#"+t)return i;return null}}),L.control.sidebar=function(t,e){return new L.Control.Sidebar(t,e)};